{"ast":null,"code":"import _taggedTemplateLiteral from \"/Users/richarddows/Projects/skyTestThree/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nimport _slicedToArray from \"/Users/richarddows/Projects/skyTestThree/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _regeneratorRuntime from \"/Users/richarddows/Projects/skyTestThree/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/richarddows/Projects/skyTestThree/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/richarddows/Projects/skyTestThree/src/containers/displaymessages.js\",\n    _templateObject,\n    _templateObject2,\n    _templateObject3,\n    _templateObject4;\n\nimport React, { useEffect, useState } from 'react';\nimport Moment from 'moment';\nimport styled from 'styled-components';\nimport { getMembers, getMessages } from '../data';\n\nvar formatMessages = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n    var m;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return getMessages();\n\n          case 2:\n            m = _context.sent;\n            console.log('messages', m);\n            return _context.abrupt(\"return\", m);\n\n          case 5:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function formatMessages() {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar formatMembers = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return getMembers();\n\n          case 2:\n            return _context2.abrupt(\"return\", _context2.sent);\n\n          case 3:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n\n  return function formatMembers() {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nvar DisplayMessages = function DisplayMessages() {\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      messages = _useState2[0],\n      setMessages = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      members = _useState4[0],\n      setMembers = _useState4[1];\n\n  useEffect(function () {\n    console.log('[] useEffect');\n\n    var fetchMessages = /*#__PURE__*/function () {\n      var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n        var response, _yield$response$json, messages;\n\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return formatMessages();\n\n              case 2:\n                response = _context3.sent;\n                _context3.next = 5;\n                return response.json();\n\n              case 5:\n                _yield$response$json = _context3.sent;\n                messages = _yield$response$json.messages;\n                console.log('messages', messages);\n\n              case 8:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3);\n      }));\n\n      return function fetchMessages() {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n\n    var fetchMembers = /*#__PURE__*/function () {\n      var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n        var response, _yield$response$json2, members;\n\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.next = 2;\n                return formatMembers();\n\n              case 2:\n                response = _context4.sent;\n                _context4.next = 5;\n                return response.json();\n\n              case 5:\n                _yield$response$json2 = _context4.sent;\n                members = _yield$response$json2.members;\n                console.log('members', members);\n\n              case 8:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4);\n      }));\n\n      return function fetchMembers() {\n        return _ref4.apply(this, arguments);\n      };\n    }();\n\n    fetchMessages();\n    fetchMembers();\n  }, []);\n  useEffect(function () {\n    console.log('members useEffect()', members);\n    setMembers(members);\n  }, [members]);\n  useEffect(function () {\n    console.log('messages useEffect()', messages);\n    setMessages(messages);\n  }, [messages]);\n\n  var getUserEmail = function getUserEmail(id) {\n    return members.find(function (m) {\n      return m.id === id;\n    }).email;\n  };\n\n  var getUserAvatar = function getUserAvatar(id) {\n    return members.find(function (m) {\n      return m.id === id;\n    }).avatar;\n  };\n\n  var getUserName = function getUserName(id) {\n    var user = members.find(function (m) {\n      return m.id === id;\n    });\n    return \"\".concat(user.firstName, \" \").concat(user.lastName);\n  };\n\n  var getTimestamp = function getTimestamp(id) {\n    return Moment(messages.find(function (m) {\n      return m.id === id;\n    }).timestamp).format('ddd mmm yyyy hh:mm');\n  };\n\n  var sortMessages = function sortMessages() {\n    return messages.length > 1 ? messages.sort(function (a, b) {\n      return a.timestamp - b.timestamp;\n    }) : [];\n  };\n\n  sortMessages();\n  console.log('after sortMessages() messages is', messages);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, messages.length > 1 && messages.map(function (m) {\n    return /*#__PURE__*/React.createElement(MessageSection, {\n      key: m.id,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(MessageArticle, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Avatar, {\n      alt: \"Avatar for \".concat(getUserName(m.userId)),\n      src: getUserAvatar(m.userId),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(Message, {\n      title: getUserEmail(m.userId),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 15\n      }\n    }, m.message), /*#__PURE__*/React.createElement(\"span\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 15\n      }\n    }, getTimestamp(m.id)))));\n  }));\n};\n\nvar MessageSection = styled.section(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n  min-height: 25px;\\n  width: 90%;\\n  margin: 0 5%;\\n  background-color: green;\\n\"])));\nvar MessageArticle = styled.article(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"\\n  border: 1px solid black;\\n\"])));\nvar Avatar = styled.img(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"\\n  width: 25px;\\n  height: 50px;\\n\"])));\nvar Message = styled.p(_templateObject4 || (_templateObject4 = _taggedTemplateLiteral([\"\\n  display: flex;\\n  flex: 0 1 auto;\\n\\n  span:nth-child(1) {\\n    flex: 0 1 25%;\\n  }\\n  span:nth-child(2) {\\n    flex: 0 1 75%;\\n  }\\n\"])));\nexport default DisplayMessages;","map":{"version":3,"sources":["/Users/richarddows/Projects/skyTestThree/src/containers/displaymessages.js"],"names":["React","useEffect","useState","Moment","styled","getMembers","getMessages","formatMessages","m","console","log","formatMembers","DisplayMessages","messages","setMessages","members","setMembers","fetchMessages","response","json","fetchMembers","getUserEmail","id","find","email","getUserAvatar","avatar","getUserName","user","firstName","lastName","getTimestamp","timestamp","format","sortMessages","length","sort","a","b","map","userId","message","MessageSection","section","MessageArticle","article","Avatar","img","Message","p"],"mappings":";;;;;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,OAAOC,MAAP,MAAmB,QAAnB;AACA,OAAOC,MAAP,MAAmB,mBAAnB;AACA,SAASC,UAAT,EAAqBC,WAArB,QAAwC,SAAxC;;AAEA,IAAMC,cAAc;AAAA,sEAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACLD,WAAW,EADN;;AAAA;AACfE,YAAAA,CADe;AAErBC,YAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAwBF,CAAxB;AAFqB,6CAGdA,CAHc;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAdD,cAAc;AAAA;AAAA;AAAA,GAApB;;AAMA,IAAMI,aAAa;AAAA,uEAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACPN,UAAU,EADH;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAbM,aAAa;AAAA;AAAA;AAAA,GAAnB;;AAIA,IAAMC,eAAe,GAAG,SAAlBA,eAAkB,GAAM;AAC5B,kBAAgCV,QAAQ,CAAC,EAAD,CAAxC;AAAA;AAAA,MAAOW,QAAP;AAAA,MAAiBC,WAAjB;;AACA,mBAA8BZ,QAAQ,CAAC,EAAD,CAAtC;AAAA;AAAA,MAAOa,OAAP;AAAA,MAAgBC,UAAhB;;AAEAf,EAAAA,SAAS,CAAC,YAAM;AACdQ,IAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ;;AACA,QAAMO,aAAa;AAAA,2EAAG;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBACGV,cAAc,EADjB;;AAAA;AACdW,gBAAAA,QADc;AAAA;AAAA,uBAEOA,QAAQ,CAACC,IAAT,EAFP;;AAAA;AAAA;AAEZN,gBAAAA,QAFY,wBAEZA,QAFY;AAGpBJ,gBAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAwBG,QAAxB;;AAHoB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAH;;AAAA,sBAAbI,aAAa;AAAA;AAAA;AAAA,OAAnB;;AAMA,QAAMG,YAAY;AAAA,2EAAG;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBACIT,aAAa,EADjB;;AAAA;AACbO,gBAAAA,QADa;AAAA;AAAA,uBAEOA,QAAQ,CAACC,IAAT,EAFP;;AAAA;AAAA;AAEXJ,gBAAAA,OAFW,yBAEXA,OAFW;AAGnBN,gBAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ,EAAuBK,OAAvB;;AAHmB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAH;;AAAA,sBAAZK,YAAY;AAAA;AAAA;AAAA,OAAlB;;AAMAH,IAAAA,aAAa;AACbG,IAAAA,YAAY;AACb,GAhBQ,EAgBN,EAhBM,CAAT;AAkBAnB,EAAAA,SAAS,CAAC,YAAM;AACdQ,IAAAA,OAAO,CAACC,GAAR,CAAY,qBAAZ,EAAmCK,OAAnC;AACAC,IAAAA,UAAU,CAACD,OAAD,CAAV;AACD,GAHQ,EAGN,CAACA,OAAD,CAHM,CAAT;AAKAd,EAAAA,SAAS,CAAC,YAAM;AACdQ,IAAAA,OAAO,CAACC,GAAR,CAAY,sBAAZ,EAAoCG,QAApC;AACAC,IAAAA,WAAW,CAACD,QAAD,CAAX;AACD,GAHQ,EAGN,CAACA,QAAD,CAHM,CAAT;;AAKA,MAAMQ,YAAY,GAAG,SAAfA,YAAe,CAACC,EAAD,EAAQ;AAC3B,WAAOP,OAAO,CAACQ,IAAR,CAAa,UAAAf,CAAC;AAAA,aAAIA,CAAC,CAACc,EAAF,KAASA,EAAb;AAAA,KAAd,EAA+BE,KAAtC;AACD,GAFD;;AAIA,MAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAACH,EAAD,EAAQ;AAC5B,WAAOP,OAAO,CAACQ,IAAR,CAAa,UAAAf,CAAC;AAAA,aAAIA,CAAC,CAACc,EAAF,KAASA,EAAb;AAAA,KAAd,EAA+BI,MAAtC;AACD,GAFD;;AAIA,MAAMC,WAAW,GAAG,SAAdA,WAAc,CAACL,EAAD,EAAQ;AAC1B,QAAMM,IAAI,GAAGb,OAAO,CAACQ,IAAR,CAAa,UAAAf,CAAC;AAAA,aAAIA,CAAC,CAACc,EAAF,KAASA,EAAb;AAAA,KAAd,CAAb;AACA,qBAAUM,IAAI,CAACC,SAAf,cAA4BD,IAAI,CAACE,QAAjC;AACD,GAHD;;AAKA,MAAMC,YAAY,GAAG,SAAfA,YAAe,CAACT,EAAD,EAAQ;AAC3B,WAAOnB,MAAM,CAACU,QAAQ,CAACU,IAAT,CAAc,UAAAf,CAAC;AAAA,aAAIA,CAAC,CAACc,EAAF,KAASA,EAAb;AAAA,KAAf,EAAgCU,SAAjC,CAAN,CAAkDC,MAAlD,CAAyD,oBAAzD,CAAP;AACD,GAFD;;AAIA,MAAMC,YAAY,GAAG,SAAfA,YAAe,GAAM;AACzB,WAAOrB,QAAQ,CAACsB,MAAT,GAAkB,CAAlB,GAAsBtB,QAAQ,CAACuB,IAAT,CAAc,UAACC,CAAD,EAAIC,CAAJ;AAAA,aAAUD,CAAC,CAACL,SAAF,GAAcM,CAAC,CAACN,SAA1B;AAAA,KAAd,CAAtB,GAA2E,EAAlF;AACD,GAFD;;AAIAE,EAAAA,YAAY;AACZzB,EAAAA,OAAO,CAACC,GAAR,CAAY,kCAAZ,EAAgDG,QAAhD;AAEA,sBACE,0CACGA,QAAQ,CAACsB,MAAT,GAAkB,CAAlB,IAAuBtB,QAAQ,CAAC0B,GAAT,CAAa,UAAA/B,CAAC;AAAA,wBACpC,oBAAC,cAAD;AAAgB,MAAA,GAAG,EAAEA,CAAC,CAACc,EAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,cAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,MAAD;AAAQ,MAAA,GAAG,uBAAgBK,WAAW,CAACnB,CAAC,CAACgC,MAAH,CAA3B,CAAX;AAAoD,MAAA,GAAG,EAAEf,aAAa,CAACjB,CAAC,CAACgC,MAAH,CAAtE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,eAEE,oBAAC,OAAD;AAAS,MAAA,KAAK,EAAEnB,YAAY,CAACb,CAAC,CAACgC,MAAH,CAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAOhC,CAAC,CAACiC,OAAT,CADF,eAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAOV,YAAY,CAACvB,CAAC,CAACc,EAAH,CAAnB,CAFF,CAFF,CADF,CADoC;AAAA,GAAd,CAD1B,CADF;AAeD,CAvED;;AAyEA,IAAMoB,cAAc,GAAGtC,MAAM,CAACuC,OAAV,wJAApB;AAOA,IAAMC,cAAc,GAAGxC,MAAM,CAACyC,OAAV,qGAApB;AAIA,IAAMC,MAAM,GAAG1C,MAAM,CAAC2C,GAAV,0GAAZ;AAKA,IAAMC,OAAO,GAAG5C,MAAM,CAAC6C,CAAV,gNAAb;AAYA,eAAerC,eAAf","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport Moment from 'moment';\nimport styled from 'styled-components';\nimport { getMembers, getMessages } from '../data';\n\nconst formatMessages = async () => {\n  const m = await getMessages();\n  console.log('messages', m);\n  return m;\n};\n\nconst formatMembers = async () => {\n  return await getMembers();\n};\n\nconst DisplayMessages = () => {\n  const [messages, setMessages] = useState([]);\n  const [members, setMembers] = useState([]);\n\n  useEffect(() => {\n    console.log('[] useEffect');\n    const fetchMessages = async () => {\n      const response = await formatMessages();\n      const { messages } = await response.json();\n      console.log('messages', messages);\n    };\n    \n    const fetchMembers = async () => {\n      const response = await formatMembers();\n      const { members } = await response.json();\n      console.log('members', members);\n    };\n\n    fetchMessages();\n    fetchMembers();\n  }, []);\n\n  useEffect(() => {\n    console.log('members useEffect()', members)\n    setMembers(members);\n  }, [members]);\n\n  useEffect(() => {\n    console.log('messages useEffect()', messages)\n    setMessages(messages);\n  }, [messages]);\n\n  const getUserEmail = (id) => {\n    return members.find(m => m.id === id).email;\n  };\n\n  const getUserAvatar = (id) => {\n    return members.find(m => m.id === id).avatar;\n  };\n\n  const getUserName = (id) => {\n    const user = members.find(m => m.id === id);\n    return `${user.firstName} ${user.lastName}`;\n  }\n\n  const getTimestamp = (id) => {\n    return Moment(messages.find(m => m.id === id).timestamp).format('ddd mmm yyyy hh:mm');\n  }\n\n  const sortMessages = () => {\n    return messages.length > 1 ? messages.sort((a, b) => a.timestamp - b.timestamp) : [];\n  };\n\n  sortMessages();\n  console.log('after sortMessages() messages is', messages);\n\n  return (\n    <>\n      {messages.length > 1 && messages.map(m => (\n        <MessageSection key={m.id}>\n          <MessageArticle>\n            <Avatar alt={`Avatar for ${getUserName(m.userId)}`} src={getUserAvatar(m.userId)} />\n            <Message title={getUserEmail(m.userId)}>\n              <span>{m.message}</span>\n              <span>{getTimestamp(m.id)}</span>\n            </Message>\n          </MessageArticle>\n        </MessageSection>\n      ))}\n    </>\n  );\n};\n\nconst MessageSection = styled.section`\n  min-height: 25px;\n  width: 90%;\n  margin: 0 5%;\n  background-color: green;\n`;\n\nconst MessageArticle = styled.article`\n  border: 1px solid black;\n`;\n\nconst Avatar = styled.img`\n  width: 25px;\n  height: 50px;\n`;\n\nconst Message = styled.p`\n  display: flex;\n  flex: 0 1 auto;\n\n  span:nth-child(1) {\n    flex: 0 1 25%;\n  }\n  span:nth-child(2) {\n    flex: 0 1 75%;\n  }\n`;\n\nexport default DisplayMessages;"]},"metadata":{},"sourceType":"module"}